@inject SignInManager<CustomUser> SignInManager
@inject UserManager<CustomUser> UserManager

@model List<Event>
@{
    ViewData["Title"] = "Мероприятия";
    string userId = UserManager.GetUserId(User);
    List<Event> actual = Model.Where(x => x.DateFinish > DateTime.Now).ToList();
}

<div class="row mt-3 pb-2">
    <div class="col-3 text-center">
        <h1 class="text-center mt-4"><a asp-action="List" asp-route-sortOrder="@ViewData["DateSortParm"]" class="link link-dark page-link">@ViewData["Title"]</a></h1>
    </div>
    <div class="col-9">
        <form asp-action="List" method="get">
            <div class="form-actions no-color">
                <p class="mt-5">
                    <strong class="w-100 pb-1" style="font-size: 1.1rem">Поиск:</strong>
                    <input type="text" name="SearchString" value="@ViewData["CurrentFilter"]" class="w-50" />
                    <button type="submit" class="btn btn-primary"><i class="bi bi-search"></i></button>
                </p>
            </div>
        </form>
    </div>
</div>
<hr>
<table class="table table-hover w-100 mt-3 pb-2 cell-centered">
    <tbody class="cell-centered mt-5">
        @foreach (var eventEv in Model)
        {
            <tr>
                <td class="text-center">
                    <h5>@eventEv.Name</h5>
                    <h4>
                        @if (eventEv.DateStart < DateTime.Now && eventEv.DateFinish > DateTime.Now)
                        {
                            if (eventEv.DateStart == eventEv.DateFinish)
                            {
                                <h5 class="text-success">Дата: @eventEv.DateFinish.ToString("D")</h5>
                            }
                            else
                            {
                                <h5 class="text-success">Дата: @eventEv.DateStart.ToString("D") - @eventEv.DateFinish.ToString("D")</h5>
                            }
                        }
                        else
                        {
                            if (eventEv.DateStart == eventEv.DateFinish)
                            {
                                <h5>Дата: @eventEv.DateFinish.ToString("D")</h5>
                            }
                            else
                            {
                                <h5>Дата: @eventEv.DateStart - @eventEv.DateFinish.ToString("D")</h5>
                            }
                        }
                    </h4>
                </td>
                <td class="w-25">
                    <a class="btn p-0 border-0 rounded-2 btn-outline-success mt-auto" asp-controller="Event" asp-action="Index" asp-route-id="@eventEv.Id">
                        @if (eventEv.PhotoPath == null)
                        {
                            <img class="rounded-2 w-100 h-100" src="~/src/Stocks/NoImage.png">
                        }
                        else
                        {
                            <img class="rounded-2 w-100 h-100" src="~/src/Events/@eventEv.PhotoPath">
                        }
                    </a>
                </td>
            </tr>
        }
    </tbody>
    <div class="col-12 col-sm-6 col-md-3 col-lg-2">
        @if (Model.Count == 0)
        {
            <a class="btn btn-outline-success h-100 w-100 d-flex align-items-center justify-content-center" style="height:234px !important;" asp-controller="Event" asp-action="Create">Объявить о мероприятии</a>
        }
        else
        {
            <a class="btn btn-outline-success h-100 w-100 d-flex align-items-center justify-content-center" asp-controller="Event" asp-action="Create">Объявить о мероприятии</a>
        }
    </div>
</table>